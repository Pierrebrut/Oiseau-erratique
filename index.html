<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>45t - Mutation de l'Oracle</title>
    <style>
        body {
            margin: 0;
            height: 100vh;
            background-color: #0b0b0b;
            color: #cfcfcf;
            font-family: 'Courier New', monospace;
            display: flex;
            justify-content: center;
            align-items: center;
            flex-direction: column;
            text-align: center;
        }
        .symbol {
            font-size: 6em;
            cursor: pointer;
            opacity: 0.8;
            transition: transform 1s ease, opacity 1s ease;
        }
        .message {
            margin-top: 20px;
            font-size: 1.3em;
            opacity: 0;
            transition: opacity 2s ease-in-out;
        }
    </style>
</head>
<body>
    <div id="symbol" class="symbol">𓅃</div>
    <div id="message" class="message"></div>

    <script>
        // Initialisation des variables
        const symbolElement = document.getElementById("symbol");
        const messageElement = document.getElementById("message");

        const states = [
            "𓅃", "𓏢", "✶", "🜃", "𓅆"
        ];

        const whispers = [
            "Le temps t'échappe.",
            "L'ombre respire en toi.",
            "Chaque souffle ajoute une empreinte.",
            "Les murs se fissurent.",
            "Qui es-tu vraiment ?",
            "La mémoire s'étend ici."
        ];

        let state = JSON.parse(localStorage.getItem("oracleState")) || {
            visits: 0,
            clicks: 0,
            mutations: []
        };

        state.visits += 1;

        function leaveTrace(message) {
            state.mutations.push({ trace: message, time: new Date().toLocaleTimeString() });
            localStorage.setItem("oracleState", JSON.stringify(state));
        }

        function updateSymbol() {
            state.clicks++;
            const nextState = states[state.clicks % states.length];
            symbolElement.textContent = nextState;
            symbolElement.style.transform = `rotate(${state.clicks * 20}deg) scale(${1 + state.clicks * 0.1})`;
            revealMessage();
            leaveTrace(`Changement vers ${nextState}`);
        }

        function revealMessage() {
            const message = whispers[Math.floor(Math.random() * whispers.length)];
            messageElement.textContent = message;
            messageElement.style.opacity = 1;
            setTimeout(() => messageElement.style.opacity = 0, 4000);
        }

        symbolElement.addEventListener("click", updateSymbol);

        // Message spécial pour la 7ème visite
        if (state.visits === 7) {
            messageElement.textContent = "Sept souffles. Le portail s'ouvre.";
            messageElement.style.opacity = 1;
            leaveTrace("Septième visite : Le portail murmure.");
        }

        console.log("Mutations enregistrées : ", state.mutations);
        localStorage.setItem("oracleState", JSON.stringify(state));
    </script>
</body>
</html>
