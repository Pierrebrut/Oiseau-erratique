<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>45t - La Voix du Petit</title>
    <style>
        body {
            margin: 0;
            background-color: #0d0d0d;
            color: #e0e0e0;
            font-family: "Courier New", monospace;
            text-align: center;
            height: 100vh;
            overflow: hidden;
            display: flex;
            justify-content: center;
            align-items: center;
            flex-direction: column;
            transition: background-color 2s;
        }
        .symbol {
            font-size: 6em;
            animation: float 5s infinite alternate ease-in-out;
            opacity: 0.9;
            transition: transform 1s, opacity 1.5s;
        }
        .message, .petit {
            font-size: 1.2em;
            margin-top: 20px;
            opacity: 0;
            transition: opacity 2s ease-in-out;
        }
        .petit {
            font-style: italic;
            color: #b22222;
            position: absolute;
            bottom: 10%;
            left: 5%;
        }
        @keyframes float {
            from { transform: translateY(0); }
            to { transform: translateY(20px); }
        }
        .fragment {
            position: absolute;
            color: rgba(255, 0, 0, 0.5);
            font-size: 1.5em;
            pointer-events: none;
            animation: drift 15s infinite alternate;
        }
        @keyframes drift {
            from { transform: translateY(0); }
            to { transform: translateY(-30px); }
        }
    </style>
</head>
<body>
    <div id="symbol" class="symbol">𓅃</div>
    <div id="message" class="message"></div>
    <div id="petit" class="petit"></div>

    <script>
        const symbols = ["𓅃", "☉", "⧉", "✶", "⟁", "⦿", "𓏢"];
        const endings = Array.from({ length: 250 }, (_, i) => `Fin #${i + 1} : ${generateMysticEnding(i + 1)}`);
        const petitMessages = [
            "Tu ne devrais pas être ici...",
            "C'est toi, ou c'est moi ?",
            "Pourquoi tu insistes autant ?",
            "Je vois ce que tu fais.",
            "Reviens. Ou pas.",
            "Les autres t'entendent-ils aussi ?",
            "Je te suis depuis le début.",
            "C’est amusant de te voir essayer…"
        ];

        let level = parseInt(localStorage.getItem("chaosLevel")) || 0;
        let secretsFound = parseInt(localStorage.getItem("secretsFound")) || 0;
        const revealedEndings = JSON.parse(localStorage.getItem("revealedEndings")) || [];

        const symbolElement = document.getElementById("symbol");
        const messageElement = document.getElementById("message");
        const petitElement = document.getElementById("petit");

        function generateMysticEnding(index) {
            const fragments = [
                "La nuit t’avale.", "Les étoiles s’éteignent une à une.", "Un cri résonne dans l’éternité.",
                "Ton souffle se perd dans l'abîme.", "Les murs pleurent du sang.", "Le silence devient vivant.",
                "L’horizon disparaît.", "La terre s’efface sous tes pieds.", "Le temps s’effondre autour de toi."
            ];
            return `${fragments[index % fragments.length]} (${index})`;
        }

        function revealEnding() {
            const remainingEndings = endings.filter(e => !revealedEndings.includes(e));
            if (remainingEndings.length === 0) {
                messageElement.textContent = "Toutes les fins ont été révélées.";
                return;
            }

            const ending = remainingEndings[Math.floor(Math.random() * remainingEndings.length)];
            messageElement.textContent = ending;
            messageElement.style.opacity = 1;

            setTimeout(() => messageElement.style.opacity = 0, 5000);

            revealedEndings.push(ending);
            localStorage.setItem("revealedEndings", JSON.stringify(revealedEndings));

            symbolElement.textContent = symbols[Math.floor(Math.random() * symbols.length)];
            console.log(`Fin révélée : ${ending}`);

            setTimeout(triggerPetit, Math.random() * 5000 + 2000);
            increaseLevel();
            hiddenTrigger();
        }

        function distortSymbol() {
            symbolElement.textContent = symbols[Math.floor(Math.random() * symbols.length)];
            symbolElement.style.transform = `rotate(${Math.random() * 360}deg) scale(${1 + Math.random() * 0.5})`;
        }

        function triggerPetit() {
            const petitMessage = petitMessages[Math.floor(Math.random() * petitMessages.length)];
            petitElement.textContent = petitMessage;
            petitElement.style.opacity = 1;
            setTimeout(() => petitElement.style.opacity = 0, 7000);
        }

        function increaseLevel() {
            level++;
            localStorage.setItem("chaosLevel", level);
            if (level % 10 === 0) {
                triggerPetitSpecial(`Niveau ${level} : Le monde change.`);
                document.body.style.backgroundColor = `rgb(${Math.random() * 50}, 0, 0)`;
            }
        }

        function triggerPetitSpecial(comment) {
            petitElement.textContent = comment;
            petitElement.style.opacity = 1;
            setTimeout(() => petitElement.style.opacity = 0, 7000);
        }

        function hiddenTrigger() {
            if (level === 13) {
                secretsFound++;
                localStorage.setItem("secretsFound", secretsFound);
                messageElement.textContent = "Tu as trouvé une fissure dans l’ombre.";
                document.body.style.backgroundColor = "#330000";
                console.log(`Secrets trouvés : ${secretsFound}`);
            }
        }

        symbolElement.addEventListener("click", () => {
            distortSymbol();
            revealEnding();
        });

        setInterval(() => {
            if (Math.random() > 0.95) triggerPetitSpecial("Le silence me rend fou. Et toi ?");
        }, 15000);

        setTimeout(() => triggerPetitSpecial("Le silence… c'est toi, non ?"), 30000);
    </script>
</body>
</html>
        
