<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <title>Jeu de la Vie - Fractales</title>
    <style>
        body {
            margin: 0;
            background: #000;
            overflow: hidden;
        }
        canvas {
            display: block;
        }
    </style>
</head>
<body>
    <canvas id="life"></canvas>
    <script>
        const canvas = document.getElementById("life");
        const ctx = canvas.getContext("2d");

        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;

        const resolution = 10;
        const cols = Math.floor(canvas.width / resolution);
        const rows = Math.floor(canvas.height / resolution);

        let grid = buildGrid();

        function buildGrid() {
            return new Array(cols).fill(null).map(() => new Array(rows).fill(0));
        }

        function seedGrid() {
            const midCol = Math.floor(cols / 2);
            const midRow = Math.floor(rows / 2);

            // Initialisation centrale pour symétrie
            grid[midCol][midRow] = 1;
            grid[midCol - 1][midRow] = 1;
            grid[midCol + 1][midRow] = 1;
            grid[midCol][midRow - 1] = 1;
            grid[midCol][midRow + 1] = 1;
        }

        function drawGrid() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            for (let col = 0; col < cols; col++) {
                for (let row = 0; row < rows; row++) {
                    const cell = grid[col][row];
                    ctx.beginPath();
                    ctx.rect(col * resolution, row * resolution, resolution, resolution);
                    ctx.fillStyle = cell ? `rgba(255, 182, 193, 0.7)` : "#000";
                    ctx.fill();
                }
            }
        }

        function countNeighbors(grid, x, y) {
            const neighbors = [
                [-1, -1], [-1, 0], [-1, 1],
                [0, -1], [0, 1],
                [1, -1], [1, 0], [1, 1]
            ];
            return neighbors.reduce((count, [dx, dy]) => {
                const col = x + dx;
                const row = y + dy;
                return count + (grid[col]?.[row] || 0);
            }, 0);
        }

        function fractalRules(grid, x, y) {
            const neighbors = countNeighbors(grid, x, y);

            // Règles spécifiques pour générer des fractales
            if (grid[x][y] === 1) {
                // Une cellule vivante reste vivante si elle a 2 ou 3 voisins
                return neighbors === 2 || neighbors === 3 ? 1 : 0;
            } else {
                // Une cellule morte devient vivante si elle a exactement 2 voisins
                return neighbors === 2 ? 1 : 0;
            }
        }

        function nextGeneration() {
            const nextGrid = buildGrid();
            for (let col = 0; col < cols; col++) {
                for (let row = 0; row < rows; row++) {
                    nextGrid[col][row] = fractalRules(grid, col, row);
                }
            }
            grid = nextGrid;
        }

        function update() {
            nextGeneration();
            drawGrid();
            requestAnimationFrame(update);
        }

        seedGrid();
        update();
    </script>
</body>
</html>
